# DesafioStone

Simple ASP.NET Core Web API to manage Invoices.

## Getting started
If you want to run the code locally, you need 2 environment variables: Secret and ConnectionString.
- Secret: The key that will be used to encrypt the tokens generated by the API.
- ConnectionString: The connection string to your data base.

These can be set in the appsettings.json in the root folder of the main project. Or they can be set as an Environment Variable in your system.

Note that the code will prioritize variables set in the appsettings.json rather than as System Environment Variables. This way you can change them more easily for debugging and testing.

To set them as System Environment Variable on Windows you can press Windows + R and run this: "rundll32 sysdm.cpl,EditEnvironmentVariables". Click on "New..." and add them as DesafioStoneSecret and DesafioStoneConnectionString respectively.

## Access
### Live
Currently the API is ruinning on a Google Cloud Run instance from a Google Container Registry image. Its image was created using Docker targeting Linux.

You can see its Swagger here: https://desafiostone-nmkn24bkqq-rj.a.run.app/swagger/index.html.

To make API requests to the api from external sources such as Postman, refer to the Swagger and simply use the https://desafiostone-nmkn24bkqq-rj.a.run.app/{endpoints...}

### Who can access it?
The only fully authorized endpoint is the "v1/users/authorize" one, which is used to validate the User and generate the 8-hour token.

All the others "users" endpoints are only authorized for Users with a Manager role, except for the "v1/users/{userId}/updatePassword" that is only accessible when the token being used was created by the user with id {userId}, in other words, only the user itself can change its password.

All the Invoice endpoints are accessible with at least a User role token.
